# ################################################################################
# purpose: rabbitmq-monitor - microservice to monitor msessages on rabbitmq server
# status: working
#
# build java code
mvn clean install -DskipTests
#
docker stop c-rabbitmq-monitor
docker rm c-rabbitmq-monitor
docker rmi i-rabbitmq-monitor
#
# build
docker build -t i-rabbitmq-monitor .
#
# run
docker run -d --name c-rabbitmq-monitor --network=n-rabbitmq -e RABBITMQ_MANAGEMENT_URL=http://c-rabbitmq:15672 -p 8676:8082 i-rabbitmq-monitor       
#
# Optional:
        -e MONITOR_INTERVAL_MS=5000
        -e RABBITMQ_MANAGEMENT_URL=http://host.docker.internal:8673
#
#docker stop c-rabbitmq-monitor
#docker start c-rabbitmq-monitor
#
# connect
#docker exec -it c-rabbitmq-monitor /bin/bash
#
# health check
curl -l http://localhost:8676/actuator/health
curl -l http://localhost:8676/actuator/info
curl -l http://localhost:8676/actuator/metrics | jq
#
# monitor docker container logs for output of the monitoring activity
docker logs c-rabbitmq-monitor
#
# ################################################################################
